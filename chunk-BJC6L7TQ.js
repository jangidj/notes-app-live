import{a as D}from"./chunk-SQYKOOWC.js";import{Ab as A,Ba as i,Ca as o,Da as _,Ga as C,Gb as m,Ha as b,Hb as g,Ja as S,Ka as c,O as d,Oa as r,Pa as E,Qa as L,R as f,S as v,T as y,U as M,ba as O,c as u,ca as a,fb as U,hb as k,ia as w,jb as z,nb as I,ra as h,sa as x}from"./chunk-HVD5NXG4.js";function G(n,t){if(n&1&&(i(0,"div",3),r(1),o()),n&2){let e=c();a(),L(" ",e.error," ")}}function N(n,t){if(n&1){let e=C();i(0,"div",4),_(1,"img",7),i(2,"div",8)(3,"h3"),r(4),o(),i(5,"p"),r(6),o()(),i(7,"button",9),S("click",function(){f(e);let l=c();return v(l.signOut())}),r(8," Sign Out "),o()()}if(n&2){let e,s,l,P,p=c();a(),b("src",((e=p.currentUser())==null?null:e.imageUrl)||"/assets/default-avatar.png",O)("alt",(s=p.currentUser())==null?null:s.name),a(3),E((l=p.currentUser())==null?null:l.name),a(2),E((P=p.currentUser())==null?null:P.email)}}function T(n,t){n&1&&(_(0,"span",11),i(1,"span"),r(2,"Signing in..."),o())}function V(n,t){n&1&&(y(),i(0,"svg",12),_(1,"path",13)(2,"path",14)(3,"path",15)(4,"path",16),o(),M(),i(5,"span"),r(6,"Sign in with Google"),o())}function H(n,t){if(n&1){let e=C();i(0,"button",10),S("click",function(){f(e);let l=c();return v(l.signInWithGoogle())}),h(1,T,3,0)(2,V,7,0),o()}if(n&2){let e=c();b("disabled",e.isLoading),a(),x(e.isLoading?1:2)}}var F=class n{authService=d(I);router=d(z);route=d(k);notesService=d(D);store=d(A);isSignedIn=this.authService.isSignedIn;currentUser=this.authService.currentUser;isLoading=!1;error="";sessionExpired=!1;ngOnInit(){return u(this,null,function*(){try{if(this.route.queryParams.subscribe(t=>{t.reason==="session_expired"&&(this.sessionExpired=!0,this.error="Your session has expired. Please sign in again to continue.")}),yield this.authService.initializeGoogleAuth(),this.authService.isSignedIn()){let t=this.authService.currentUser()?.email||null;this.notesService.loadFromStorage(t),this.store.dispatch(m.loadNotes()),this.store.dispatch(g.loadCategories());let e=this.route.snapshot.queryParams.returnUrl||"/";this.router.navigate([e],{replaceUrl:!0})}else this.notesService.loadFromStorage(null),this.store.dispatch(m.loadNotes()),this.store.dispatch(g.loadCategories())}catch(t){this.error=t?.message||"Failed to initialize Google authentication. Please check your configuration.",console.error("Auth initialization error:",t)}})}signInWithGoogle(){return u(this,null,function*(){this.isLoading=!0,this.error="",this.sessionExpired=!1;try{yield this.authService.signIn();let t=this.authService.currentUser()?.email||null;this.notesService.loadFromStorage(t),this.store.dispatch(m.loadNotes()),this.store.dispatch(g.loadCategories());let e=this.route.snapshot.queryParams.returnUrl||"/";this.router.navigate([e],{replaceUrl:!0})}catch(t){this.error="Failed to sign in. Please try again.",console.error("Sign in error:",t)}finally{this.isLoading=!1}})}signOut(){return u(this,null,function*(){try{yield this.authService.signOut(),this.notesService.clearCurrentUserData(),this.notesService.loadFromStorage(null),this.store.dispatch(m.loadNotes()),this.store.dispatch(g.loadCategories())}catch(t){console.error("Sign out error:",t)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["app-login"]],decls:13,vars:2,consts:[[1,"login-container"],[1,"login-card"],[1,"login-header"],[1,"error-message"],[1,"user-info"],[1,"btn","btn-google",3,"disabled"],[1,"login-footer"],[1,"user-avatar",3,"src","alt"],[1,"user-details"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-google",3,"click","disabled"],[1,"spinner"],["width","18","height","18","viewBox","0 0 18 18","fill","none"],["d","M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z","fill","#4285F4"],["d","M9 18c2.43 0 4.467-.806 5.965-2.184l-2.908-2.258c-.806.54-1.837.86-3.057.86-2.35 0-4.34-1.587-5.053-3.72H.957v2.332C2.438 15.983 5.482 18 9 18z","fill","#34A853"],["d","M3.947 10.698c-.18-.54-.282-1.117-.282-1.698s.102-1.158.282-1.698V4.97H.957C.348 6.175 0 7.55 0 9s.348 2.825.957 4.03l2.99-2.332z","fill","#FBBC05"],["d","M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.97L3.947 7.302C4.66 5.167 6.65 3.58 9 3.58z","fill","#EA4335"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),r(4,"\u{1F4DD} Notes App"),o(),i(5,"p"),r(6,"Sign in to sync your notes with Google Drive"),o()(),h(7,G,2,1,"div",3),h(8,N,9,4,"div",4)(9,H,3,2,"button",5),i(10,"div",6)(11,"p"),r(12,"Your notes will be securely stored in your Google Drive"),o()()()()),e&2&&(a(7),x(s.error?7:-1),a(),x(s.isSignedIn()?8:9))},dependencies:[U],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--gradient-primary);padding:2rem}.login-card[_ngcontent-%COMP%]{background:var(--bg-elevated);border-radius:16px;padding:3rem;box-shadow:var(--shadow-xl);border:1px solid var(--border-color);max-width:400px;width:100%;text-align:center}@media (max-width: 640px){.login-card[_ngcontent-%COMP%]{padding:2rem 1.5rem}}.login-header[_ngcontent-%COMP%]{margin-bottom:2rem}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;color:var(--text-primary)}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.error-message[_ngcontent-%COMP%]{background:var(--error-color);color:#fff;padding:1rem;border-radius:8px;margin-bottom:1.5rem;font-size:.875rem;white-space:pre-wrap;text-align:left;line-height:1.6;max-height:400px;overflow-y:auto}.user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:1.5rem 0}.user-info[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;border:3px solid var(--border-color)}.user-info[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .25rem;color:var(--text-primary)}.user-info[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary);font-size:.875rem}.btn-google[_ngcontent-%COMP%]{width:100%;padding:.875rem 1.5rem;min-height:50px;background:#fff;color:#333;border:1.5px solid var(--border-color);border-radius:14px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .15s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:center;gap:.75rem;box-shadow:0 2px 8px #0000001a,0 1px 3px #00000014;touch-action:manipulation;-webkit-tap-highlight-color:transparent;letter-spacing:-.01em;-webkit-font-smoothing:antialiased}@media (max-width: 640px){.btn-google[_ngcontent-%COMP%]{padding:1rem 1.5rem;min-height:52px;font-size:1rem;box-shadow:0 4px 12px #0000001f,0 2px 4px #00000014}}.btn-google[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #00000026,0 2px 6px #0000001a;border-color:var(--border-hover)}.btn-google[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.97);box-shadow:0 1px 4px #0000001a,0 1px 2px #00000014;transition-duration:.1s}.btn-google[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none!important}.btn-google[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.spinner[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.login-footer[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-tertiary);font-size:.875rem}"]})};export{F as Login};
