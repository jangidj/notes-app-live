import{a as B}from"./chunk-FMLZKYIE.js";import"./chunk-74LLULWK.js";import{a as z,b as F,c as L}from"./chunk-MVTUDABA.js";import{a as x,b as j}from"./chunk-LOCZZ25B.js";import{a as U,c as $,g as R}from"./chunk-ESAVHXRM.js";import{p as A}from"./chunk-OODGCCPB.js";import{Ca as b,Ea as d,Ga as m,Ja as s,Ka as v,La as N,P as M,S as u,T as _,Ua as T,Va as w,_ as g,_a as S,ab as D,ca as O,cb as V,da as l,ia as E,pa as f,qa as h,ra as P,sa as I,ta as k,ua as C,va as p,wa as o,xa as r,ya as y}from"./chunk-FCD34S5F.js";var G=(a,n)=>n.id;function J(a,n){if(a&1){let e=b();o(0,"button",29),d("click",function(){u(e);let i=m();return _(i.deleteNote())}),o(1,"span"),s(2,"\u{1F5D1}\uFE0F"),r()()}}function K(a,n){a&1&&(o(0,"option",12),s(1,"Loading categories..."),r())}function Q(a,n){if(a&1&&(o(0,"option",30),s(1),r()),a&2){let e=n.$implicit;p("value",e.id),l(),v(e.name)}}function X(a,n){if(a&1&&k(0,Q,2,2,"option",30,G),a&2){let e=m();C(e.categories())}}function Y(a,n){if(a&1){let e=b();o(0,"span",17),s(1),o(2,"button",31),d("click",function(){let i=u(e).$implicit,c=m();return _(c.removeTag(i))}),s(3,"\xD7"),r()()}if(a&2){let e=n.$implicit;l(),N(" ",e," ")}}function Z(a,n){if(a&1){let e=b();o(0,"div",22),y(1,"img",32),o(2,"button",33),d("click",function(){let i=u(e).$index,c=m();return _(c.removeImage(i))}),s(3,"\xD7"),r()()}if(a&2){let e=n.$implicit;l(),p("src",e,O)}}function ee(a,n){if(a&1&&(o(0,"p",36),s(1),r()),a&2){let e=m().$implicit;l(),v(e.description)}}function te(a,n){if(a&1){let e=b();o(0,"div",26)(1,"div",34)(2,"a",35),s(3),r(),f(4,ee,2,1,"p",36),o(5,"span",37),s(6),r()(),o(7,"button",38),d("click",function(){let i=u(e).$index,c=m();return _(c.removeLink(i))}),s(8,"\xD7"),r()()}if(a&2){let e=n.$implicit;l(2),p("href",e.url,O),l(),N(" ",e.title," "),l(),h(e.description?4:-1),l(2),v(e.url)}}function ne(a,n){if(a&1){let e=b();o(0,"div",27)(1,"input",39),d("input",function(i){u(e);let c=m();return _(c.linkUrl.set(i.target.value))}),r(),o(2,"input",40),d("input",function(i){u(e);let c=m();return _(c.linkTitle.set(i.target.value))}),r(),o(3,"input",41),d("input",function(i){u(e);let c=m();return _(c.linkDescription.set(i.target.value))}),r(),o(4,"div",42)(5,"button",43),d("click",function(){u(e);let i=m();return _(i.addLink())}),s(6,"Add"),r(),o(7,"button",44),d("click",function(){u(e);let i=m();return _(i.showLinkForm.set(!1))}),s(8,"Cancel"),r()()()}if(a&2){let e=m();l(),p("value",e.linkUrl()),l(),p("value",e.linkTitle()),l(),p("value",e.linkDescription())}}function ie(a,n){if(a&1){let e=b();o(0,"button",44),d("click",function(){u(e);let i=m();return _(i.showLinkForm.set(!0))}),s(1," \u{1F517} Add Link "),r()}}var H=class a{route=M(D);router=M(V);store=M(A);title=g("");content=g("");categoryId=g("");tags=g([]);images=g([]);links=g([]);tagInput=g("");linkUrl=g("");linkTitle=g("");linkDescription=g("");showLinkForm=g(!1);isSaving=g(!1);noteId=g(null);isEditMode=T(()=>this.noteId()!==null);categories=this.store.selectSignal($);allNotes=this.store.selectSignal(U);constructor(){w(()=>{let n=this.noteId(),e=this.allNotes();n&&e.length>0&&this.loadNote(n)}),w(()=>{let n=this.categories(),e=this.categoryId();if(!this.isEditMode()&&n.length>0&&!e){let t=n[0];t&&this.categoryId.set(t.id)}})}ngOnInit(){this.store.dispatch(x.loadNotes()),this.store.dispatch(j.loadCategories()),this.route.paramMap.subscribe(n=>{let e=n.get("id");if(e&&e!=="new")this.noteId.set(e),this.allNotes().length>0&&this.loadNote(e);else{this.noteId.set(null),this.title.set(""),this.content.set(""),this.tags.set([]),this.images.set([]),this.links.set([]);let t=this.categories();t.length>0&&this.categoryId.set(t[0].id)}})}loadNote(n){let t=this.allNotes().find(i=>i.id===n);t?(this.title.set(t.title),this.content.set(t.content),this.categoryId.set(t.categoryId),this.tags.set(t.tags||[]),this.images.set(t.images||[]),this.links.set(t.links||[])):console.warn(`Note with id ${n} not found`)}onImageUpload(n){let e=n.target;if(e.files&&e.files.length>0){let t=e.files[0];if(t.type.startsWith("image/")){let i=new FileReader;i.onload=c=>{let W=c.target?.result;this.images.update(q=>[...q,W])},i.readAsDataURL(t)}}}removeImage(n){this.images.update(e=>e.filter((t,i)=>i!==n))}addTag(){let n=this.tagInput().trim();n&&!this.tags().includes(n)&&(this.tags.update(e=>[...e,n]),this.tagInput.set(""))}removeTag(n){this.tags.update(e=>e.filter(t=>t!==n))}addLink(){let n=this.linkUrl().trim(),e=this.linkTitle().trim()||n;if(n){let t={url:n,title:e,description:this.linkDescription().trim()||void 0};this.links.update(i=>[...i,t]),this.linkUrl.set(""),this.linkTitle.set(""),this.linkDescription.set(""),this.showLinkForm.set(!1)}}removeLink(n){this.links.update(e=>e.filter((t,i)=>i!==n))}saveNote(){if(!this.title().trim()&&!this.content().trim())return;if(!this.categoryId()||this.categoryId().trim()===""){let e=this.categories()[0];if(e)this.categoryId.set(e.id);else{console.error("No category available. Please create a category first.");return}}this.isSaving.set(!0);let n={title:this.title().trim()||"Untitled Note",content:this.content().trim(),categoryId:this.categoryId(),tags:this.tags().length>0?this.tags():void 0,images:this.images().length>0?this.images():void 0,links:this.links().length>0?this.links():void 0};if(this.isEditMode()){let e=this.noteId();if(!e){console.error("Note ID is missing"),this.isSaving.set(!1);return}this.store.dispatch(x.updateNote({id:e,updates:n}))}else this.store.dispatch(x.createNote({note:n}));setTimeout(()=>{this.isSaving.set(!1),this.router.navigate(["/"])},300)}deleteNote(){this.noteId()&&confirm("Are you sure you want to delete this note?")&&(this.store.dispatch(x.deleteNote({id:this.noteId()})),this.router.navigate(["/"]))}cancel(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=E({type:a,selectors:[["app-note-editor"]],decls:51,vars:10,consts:[[1,"note-editor"],[1,"editor-container"],[1,"editor-header"],["aria-label","Back",1,"icon-btn","back-btn",3,"click"],[1,"editor-title"],[1,"header-actions"],["aria-label","Delete",1,"icon-btn","danger-btn"],["aria-label","Save",1,"icon-btn","save-btn",3,"click","disabled"],[1,"editor-content"],["type","text","placeholder","Note Title","autocomplete","off","data-form-type","other",1,"note-title-input",3,"input","value"],[1,"form-group"],["autocomplete","off","data-form-type","other",1,"form-select",3,"change","value"],["value",""],["placeholder","Start writing...","rows","8","autocomplete","off","data-form-type","other",1,"note-content-input",3,"input","value"],[1,"form-section"],[1,"tags-container"],[1,"tags-list"],[1,"tag"],[1,"tag-input-group"],["type","text","placeholder","Add tag","autocomplete","off","data-form-type","other",1,"tag-input",3,"input","keyup.enter","value"],[1,"btn","btn-small",3,"click"],[1,"images-container"],[1,"image-preview"],[1,"image-upload-btn"],["type","file","accept","image/*",2,"display","none",3,"change"],[1,"links-container"],[1,"link-item"],[1,"link-form"],[1,"btn","btn-secondary"],["aria-label","Delete",1,"icon-btn","danger-btn",3,"click"],[3,"value"],[1,"tag-remove",3,"click"],["alt","Note image",3,"src"],[1,"image-remove",3,"click"],[1,"link-content"],["target","_blank",1,"link-title",3,"href"],[1,"link-description"],[1,"link-url"],[1,"link-remove",3,"click"],["type","url","placeholder","URL","autocomplete","off","data-form-type","other",1,"form-input",3,"input","value"],["type","text","placeholder","Title (optional)","autocomplete","off","data-form-type","other",1,"form-input",3,"input","value"],["type","text","placeholder","Description (optional)","autocomplete","off","data-form-type","other",1,"form-input",3,"input","value"],[1,"link-form-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"header",2)(3,"button",3),d("click",function(){return t.cancel()}),o(4,"span"),s(5,"\u2190"),r()(),o(6,"h2",4),s(7),r(),o(8,"div",5),y(9,"app-theme-toggle"),f(10,J,3,0,"button",6),o(11,"button",7),d("click",function(){return t.saveNote()}),o(12,"span"),s(13),r()()()(),o(14,"div",8)(15,"input",9),d("input",function(c){return t.title.set(c.target.value)}),r(),o(16,"div",10)(17,"select",11),d("change",function(c){return t.categoryId.set(c.target.value)}),f(18,K,2,0,"option",12)(19,X,2,0),r()(),o(20,"textarea",13),d("input",function(c){return t.content.set(c.target.value)}),r(),o(21,"div",14)(22,"label"),s(23,"Tags"),r(),o(24,"div",15)(25,"div",16),k(26,Y,4,1,"span",17,I),r(),o(28,"div",18)(29,"input",19),d("input",function(c){return t.tagInput.set(c.target.value)})("keyup.enter",function(){return t.addTag()}),r(),o(30,"button",20),d("click",function(){return t.addTag()}),s(31,"Add"),r()()()(),o(32,"div",14)(33,"label"),s(34,"Images"),r(),o(35,"div",21),k(36,Z,4,1,"div",22,P),o(38,"label",23)(39,"input",24),d("change",function(c){return t.onImageUpload(c)}),r(),o(40,"span"),s(41,"\u{1F4F7} Add"),r()()()(),o(42,"div",14)(43,"label"),s(44,"Links"),r(),o(45,"div",25),k(46,te,9,4,"div",26,P),f(48,ne,9,3,"div",27)(49,ie,2,0,"button",28),r()()()(),y(50,"app-bottom-nav"),r()),e&2&&(l(7),v(t.isEditMode()?"Edit Note":"New Note"),l(3),h(t.isEditMode()?10:-1),l(),p("disabled",t.isSaving()),l(2),v(t.isSaving()?"\u23F3":"\u2713"),l(2),p("value",t.title()),l(2),p("value",t.categoryId()),l(),h(t.categories().length===0?18:19),l(2),p("value",t.content()),l(6),C(t.tags()),l(3),p("value",t.tagInput()),l(7),C(t.images()),l(10),C(t.links()),l(2),h(t.showLinkForm()?48:49))},dependencies:[S,L,z,F,B,R],styles:[".note-editor[_ngcontent-%COMP%]{min-height:100vh;background:var(--bg-primary);padding-bottom:env(safe-area-inset-bottom);transition:background-color .3s ease}.editor-container[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;background:var(--bg-elevated);min-height:100vh;border:none;box-shadow:none}@media (min-width: 768px){.editor-container[_ngcontent-%COMP%]{max-width:600px;border-radius:0}}.editor-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;border-bottom:1px solid var(--border-color);background:var(--bg-elevated);position:sticky;top:0;z-index:10;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:10px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.25rem;color:var(--text-primary);transition:all .2s ease;flex-shrink:0}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:var(--bg-hover)}.editor-header[_ngcontent-%COMP%]   .editor-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:1.125rem;font-weight:600;color:var(--text-primary)}.editor-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:10px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.125rem;transition:all .2s ease;padding:0}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95);background:var(--bg-hover)}.editor-header[_ngcontent-%COMP%]   .icon-btn.save-btn[_ngcontent-%COMP%]{background:var(--primary-color);color:var(--text-inverse);border-color:var(--primary-color)}.editor-header[_ngcontent-%COMP%]   .icon-btn.save-btn[_ngcontent-%COMP%]:active:not(:disabled){background:var(--primary-hover)}.editor-header[_ngcontent-%COMP%]   .icon-btn.danger-btn[_ngcontent-%COMP%]{background:var(--error-color);color:var(--text-inverse);border-color:var(--error-color)}.editor-header[_ngcontent-%COMP%]   .icon-btn.danger-btn[_ngcontent-%COMP%]:active:not(:disabled){background:#dc2626}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.editor-content[_ngcontent-%COMP%]{padding:1rem}.note-title-input[_ngcontent-%COMP%]{width:100%;border:none;outline:none;font-size:1.5rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem;padding:.5rem 0;background:transparent}.note-title-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--border-color);border-radius:10px;font-size:1rem;background:var(--bg-primary);color:var(--text-primary);cursor:pointer}.form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.note-content-input[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border-color);border-radius:10px;padding:1rem;font-size:1rem;line-height:1.6;color:var(--text-primary);resize:vertical;min-height:200px;margin-bottom:1.5rem;font-family:inherit;background:var(--bg-primary)}.note-content-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.note-content-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.form-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.75rem;font-weight:500;color:var(--text-primary);font-size:.875rem}.tags-container[_ngcontent-%COMP%]   .tags-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.75rem}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;background:var(--primary-color);color:var(--text-inverse);padding:.5rem .75rem;border-radius:16px;font-size:.875rem;font-weight:500}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-inverse);cursor:pointer;font-size:1.125rem;line-height:1;padding:0;width:18px;height:18px;display:flex;align-items:center;justify-content:center;border-radius:50%}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]:active{background:#fff3}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:1px solid var(--border-color);border-radius:10px;font-size:1rem;background:var(--bg-primary);color:var(--text-primary)}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.images-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]{position:relative;width:100px;height:100px;border-radius:10px;overflow:hidden;border:2px solid var(--border-color)}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-remove[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;background:#000000b3;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-remove[_ngcontent-%COMP%]:active{background:#000000e6}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]{width:100px;height:100px;border:2px dashed var(--border-color);border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;background:var(--bg-secondary)}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]:active{border-color:var(--primary-color);background:var(--bg-hover)}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.links-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1rem;background:var(--bg-secondary);border-radius:10px;border:1px solid var(--border-color)}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]{flex:1}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-title[_ngcontent-%COMP%]{display:block;font-weight:600;color:var(--primary-color);text-decoration:none;margin-bottom:.25rem;font-size:.875rem}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-description[_ngcontent-%COMP%]{margin:.25rem 0;color:var(--text-secondary);font-size:.75rem}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-url[_ngcontent-%COMP%]{display:block;color:var(--text-tertiary);font-size:.7rem;word-break:break-all}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-remove[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);cursor:pointer;font-size:1.25rem;padding:.25rem}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-remove[_ngcontent-%COMP%]:active{color:var(--text-primary)}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]{padding:1rem;background:var(--bg-secondary);border-radius:10px;border:1px solid var(--border-color);display:flex;flex-direction:column;gap:.75rem}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--border-color);border-radius:10px;font-size:1rem;background:var(--bg-primary);color:var(--text-primary)}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .link-form-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:10px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .2s ease}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color);color:var(--text-inverse)}.btn.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background:var(--primary-hover)}.btn.btn-secondary[_ngcontent-%COMP%]{background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border-color)}.btn.btn-secondary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background:var(--bg-hover)}.btn.btn-small[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem}"]})};export{H as NoteEditor};
