import{a as B}from"./chunk-5XES65YU.js";import{a as T}from"./chunk-WYIH2S7K.js";import{a as A,c as G,h as L}from"./chunk-7N7ENV44.js";import{$ as i,$a as D,Ab as N,Ba as O,Bb as V,Da as b,Fa as m,Ja as n,Ka as p,La as f,M as d,Oa as M,P as u,Q as _,Qa as k,Ra as E,_ as h,_a as w,c as v,db as I,ea as S,eb as F,hb as z,ma as y,na as x,sa as g,ta as t,ua as e,ub as U,va as C}from"./chunk-AEIAZLYF.js";var R=()=>["/login"];function q(o,a){if(o&1&&(t(0,"p",12),n(1),k(2,"date"),e()),o&2){let r=m(2);i(),f("Last synced: ",E(2,1,r.lastSynced,"short"))}}function H(o,a){if(o&1){let r=O();t(0,"div",4)(1,"div",5),C(2,"img",6),e(),t(3,"h2"),n(4),e(),t(5,"p",7),n(6),e()(),t(7,"div",8)(8,"h3"),n(9,"Google Drive Sync"),e(),t(10,"div",9)(11,"button",10),b("click",function(){u(r);let s=m();return _(s.syncToDrive())}),n(12),e(),t(13,"button",11),b("click",function(){u(r);let s=m();return _(s.syncFromDrive())}),n(14),e()(),y(15,q,3,4,"p",12),e(),t(16,"div",13)(17,"h3"),n(18,"Statistics"),e(),t(19,"div",14)(20,"div",15)(21,"span",16),n(22),e(),t(23,"span",17),n(24,"Notes"),e()(),t(25,"div",15)(26,"span",16),n(27),e(),t(28,"span",17),n(29,"Categories"),e()()()(),t(30,"div",18)(31,"button",19),b("click",function(){u(r);let s=m();return _(s.signOut())}),n(32," Sign Out "),e()()}if(o&2){let r,l,s,P,c=m();i(2),g("src",((r=c.currentUser())==null?null:r.imageUrl)||"/assets/default-avatar.png",h)("alt",(l=c.currentUser())==null?null:l.name),i(2),p((s=c.currentUser())==null?null:s.name),i(2),p((P=c.currentUser())==null?null:P.email),i(5),g("disabled",c.isSyncing),i(),f(" ",c.isSyncing?"\u23F3 Syncing...":"\u2601\uFE0F Sync to Drive"," "),i(),g("disabled",c.isSyncing),i(),f(" ",c.isSyncing?"\u23F3 Syncing...":"\u2B07\uFE0F Sync from Drive"," "),i(),x(c.lastSynced?15:-1),i(7),p(c.notes().length),i(5),p(c.categories().length)}}function J(o,a){o&1&&(t(0,"div",3)(1,"p"),n(2,"Sign in with Google to sync your notes"),e(),t(3,"a",20),n(4,"Sign In"),e()()),o&2&&(i(3),g("routerLink",M(1,R)))}var j=class o{authService=d(z);driveService=d(B);notesService=d(T);store=d(U);router=d(I);isSignedIn=this.authService.isSignedIn;currentUser=this.authService.currentUser;notes=this.store.selectSignal(A);categories=this.store.selectSignal(G);isSyncing=!1;lastSynced=null;ngOnInit(){}syncToDrive(){return v(this,null,function*(){if(this.authService.isSignedIn()){this.isSyncing=!0;try{yield this.driveService.syncToDrive(this.notes(),this.categories()),this.lastSynced=new Date}catch(a){console.error("Error syncing to Drive:",a)}finally{this.isSyncing=!1}}})}syncFromDrive(){return v(this,null,function*(){if(this.authService.isSignedIn()){this.isSyncing=!0;try{(yield this.driveService.syncFromDrive())&&(this.lastSynced=new Date)}catch(a){console.error("Error syncing from Drive:",a)}finally{this.isSyncing=!1}}})}signOut(){return v(this,null,function*(){try{yield this.authService.signOut(),this.notesService.clearCurrentUserData(),this.notesService.loadFromStorage(null),this.store.dispatch(N.loadNotes()),this.store.dispatch(V.loadCategories()),this.router.navigate(["/login"])}catch(a){console.error("Error signing out:",a)}})}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=S({type:o,selectors:[["app-profile"]],decls:8,vars:1,consts:[[1,"profile"],[1,"profile-header"],[1,"profile-content"],[1,"sign-in-prompt"],[1,"user-section"],[1,"user-avatar-container"],[1,"user-avatar",3,"src","alt"],[1,"user-email"],[1,"sync-section"],[1,"sync-controls"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"sync-time"],[1,"stats-section"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-value"],[1,"stat-label"],[1,"actions-section"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-primary",3,"routerLink"]],template:function(r,l){r&1&&(t(0,"div",0)(1,"header",1)(2,"h1"),n(3,"Profile"),e()(),t(4,"div",2),y(5,H,33,11)(6,J,5,2,"div",3),e(),C(7,"app-bottom-nav"),e()),r&2&&(i(5),x(l.isSignedIn()?5:6))},dependencies:[D,F,L,w],styles:[".profile[_ngcontent-%COMP%]{min-height:100vh;background:var(--bg-primary);padding-bottom:80px;padding-top:env(safe-area-inset-top)}.profile-header[_ngcontent-%COMP%]{background:var(--bg-elevated);border-bottom:1px solid var(--border-color);padding:1rem;position:sticky;top:0;z-index:10;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.profile-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:var(--text-primary)}.profile-content[_ngcontent-%COMP%]{padding:1.5rem 1rem}.user-section[_ngcontent-%COMP%]{text-align:center;padding:2rem 0;margin-bottom:2rem}.user-section[_ngcontent-%COMP%]   .user-avatar-container[_ngcontent-%COMP%]{margin-bottom:1rem}.user-section[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;border:3px solid var(--border-color);object-fit:cover}.user-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--text-primary);font-size:1.5rem}.user-section[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary);font-size:.875rem}.sync-section[_ngcontent-%COMP%]{background:var(--bg-elevated);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:1px solid var(--border-color)}.sync-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--text-primary)}.sync-section[_ngcontent-%COMP%]   .sync-controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-bottom:1rem}.sync-section[_ngcontent-%COMP%]   .sync-time[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:var(--text-secondary);text-align:center}.stats-section[_ngcontent-%COMP%]{background:var(--bg-elevated);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:1px solid var(--border-color)}.stats-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--text-primary)}.stats-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:10px;padding:1.5rem;text-align:center;border:1px solid var(--border-color)}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-size:2rem;font-weight:700;color:var(--primary-color);margin-bottom:.5rem}.stats-section[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--text-secondary)}.actions-section[_ngcontent-%COMP%]{padding:1rem 0}.actions-section[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.sign-in-prompt[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.sign-in-prompt[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:var(--text-secondary)}.sign-in-prompt[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;max-width:300px}.btn[_ngcontent-%COMP%]{padding:.875rem 1.5rem;border:none;border-radius:10px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .2s ease}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color);color:var(--text-inverse)}.btn.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background:var(--primary-hover)}.btn.btn-secondary[_ngcontent-%COMP%]{background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border-color)}.btn.btn-secondary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background:var(--bg-hover)}.btn.btn-danger[_ngcontent-%COMP%]{background:var(--error-color);color:var(--text-inverse)}.btn.btn-danger[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background:#dc2626}"]})};export{j as Profile};
