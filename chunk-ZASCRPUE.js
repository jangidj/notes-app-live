import{a as Ce}from"./chunk-F7FA5QDT.js";import"./chunk-2LSVSJYO.js";import{a as de,b as ge,c as me,d as pe,e as ue,f as _e,g as be,h as ve}from"./chunk-QSMTR7O2.js";import{a as se}from"./chunk-2XLQIVWH.js";import{a as he,c as xe,g as fe,h as Me}from"./chunk-XYIVAT5K.js";import{Aa as M,Ab as ce,Ba as P,Ca as w,Da as F,Ga as v,Gb as V,Ha as G,Hb as le,Ia as m,Ja as U,Ka as l,La as X,Ma as T,O as S,Oa as p,Pa as D,Qa as j,R as d,Ra as ne,S as g,T as K,Z as _,Za as ie,_a as Q,a as b,aa as L,b as I,ba as q,c as J,ca as r,da as ee,fb as $,hb as oe,ia as A,jb as ae,nb as re,qa as te,ra as h,sa as x,ta as R,ua as Z,va as N,wa as z,xa as u,ya as s,za as c}from"./chunk-QFRUTNPX.js";function ye(o,t){o&1&&F(0,"span",2)}function Ie(o,t){o&1&&(K(),P(0,"svg",3),F(1,"path",5)(2,"line",6),w())}function Ee(o,t){o&1&&(P(0,"div",12),F(1,"span",2),P(2,"span"),p(3,"Analyzing content..."),w()())}function Se(o,t){o&1&&(P(0,"div",13)(1,"span"),p(2,"No tag suggestions available"),w()())}function Te(o,t){o&1&&(P(0,"span",17),p(1,"\u2713"),w())}function Ne(o,t){o&1&&(P(0,"span",18),p(1,"+"),w())}function ze(o,t){if(o&1){let e=v();P(0,"button",15),U("click",function(){let i=d(e).$implicit,a=l(3);return g(a.selectTag(i))}),P(1,"span",16),p(2),w(),h(3,Te,2,0,"span",17)(4,Ne,2,0,"span",18),w()}if(o&2){let e=t.$implicit,n=l(3);T("already-added",n.existingTags.includes(e)),G("title",n.existingTags.includes(e)?"Already added":"Click to add tag"),r(2),D(e),r(),x(n.existingTags.includes(e)?3:4)}}function De(o,t){if(o&1&&N(0,ze,5,5,"button",14,Z),o&2){let e=l(2);z(e.suggestions())}}function Ve(o,t){if(o&1){let e=v();P(0,"div",7)(1,"div",8)(2,"span",9),p(3,"\u2728 Tag Suggestions"),w(),P(4,"button",10),U("click",function(){d(e);let i=l();return g(i.closeSuggestions())}),p(5,"\xD7"),w()(),P(6,"div",11),h(7,Ee,4,0,"div",12)(8,Se,3,0,"div",13)(9,De,2,0),w()()}if(o&2){let e=l();T("visible",e.showSuggestions()),r(7),x(e.isProcessing()?7:e.suggestions().length===0?8:9)}}var B=class o{content="";title="";existingTags=[];tagSelected=new ee;geminiService=S(be);isProcessing=_(!1);tooltip=_("Suggest tags from content");showSuggestions=_(!1);suggestions=_([]);onDocumentClick(t){let e=t.target;this.showSuggestions()&&!e.closest(".ai-tag-wrapper")&&this.closeSuggestions()}handleClick(){return J(this,null,function*(){if(!this.isProcessing()){if(this.showSuggestions()){this.closeSuggestions();return}if(!this.content.trim()&&!this.title.trim()){this.tooltip.set("Add content to generate tags"),setTimeout(()=>{this.tooltip.set("Suggest tags from content")},2e3);return}this.isProcessing.set(!0),this.tooltip.set("Analyzing content..."),this.showSuggestions.set(!0);try{let t=yield this.geminiService.generateTagSuggestions(this.content,this.title,this.existingTags);this.suggestions.set(t),this.tooltip.set(`${t.length} tag suggestions available`)}catch(t){console.error("Failed to generate tag suggestions:",t),this.tooltip.set("Failed to generate suggestions"),this.suggestions.set([])}finally{this.isProcessing.set(!1)}}})}selectTag(t){this.existingTags.includes(t)||this.tagSelected.emit(t)}closeSuggestions(){this.showSuggestions.set(!1),this.tooltip.set("Suggest tags from content")}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=A({type:o,selectors:[["app-ai-tag-suggestions"]],hostBindings:function(e,n){e&1&&m("click",function(a){return n.onDocumentClick(a)},q)},inputs:{content:"content",title:"title",existingTags:"existingTags"},outputs:{tagSelected:"tagSelected"},decls:5,vars:8,consts:[[1,"ai-tag-wrapper"],["type","button",1,"ai-tag-btn",3,"click","title"],[1,"spinner"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],[1,"tag-suggestions-dropdown",3,"visible"],["d","M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"],["x1","7","y1","7","x2","7.01","y2","7"],[1,"tag-suggestions-dropdown"],[1,"suggestions-header"],[1,"suggestions-title"],["aria-label","Close suggestions",1,"close-btn",3,"click"],[1,"suggestions-list"],[1,"loading-state"],[1,"empty-state"],[1,"tag-suggestion-item",3,"already-added","title"],[1,"tag-suggestion-item",3,"click","title"],[1,"tag-text"],[1,"tag-status"],[1,"tag-icon"]],template:function(e,n){e&1&&(P(0,"div",0)(1,"button",1),U("click",function(){return n.handleClick()}),h(2,ye,1,0,"span",2)(3,Ie,3,0,":svg:svg",3),w(),h(4,Ve,10,3,"div",4),w()),e&2&&(T("show-dropdown",n.showSuggestions()),r(),T("loading",n.isProcessing()),G("title",n.tooltip()),te("aria-label",n.tooltip()),r(),x(n.isProcessing()?2:3),r(2),x(n.showSuggestions()?4:-1))},dependencies:[$],styles:[".ai-tag-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.ai-tag-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;padding:0;border:none;border-radius:6px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);flex-shrink:0;box-shadow:0 2px 4px #667eea4d;position:relative;overflow:hidden;z-index:1}.ai-tag-btn[_ngcontent-%COMP%]:hover:not(.loading){transform:scale(1.1);box-shadow:0 4px 8px #667eea66}.ai-tag-btn[_ngcontent-%COMP%]:active:not(.loading){transform:scale(.95)}.ai-tag-btn.loading[_ngcontent-%COMP%]{cursor:wait;opacity:.7}.ai-tag-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;stroke:currentColor}.ai-tag-btn[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.tag-suggestions-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 8px);right:0;min-width:240px;max-width:320px;background:var(--bg-elevated);border:1px solid var(--border-color);border-radius:12px;box-shadow:0 8px 24px #00000026;z-index:1000;opacity:0;visibility:hidden;transform:translateY(-10px);transition:all .2s cubic-bezier(.4,0,.2,1);overflow:hidden}.tag-suggestions-dropdown.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:translateY(0)}@media (max-width: 640px){.tag-suggestions-dropdown[_ngcontent-%COMP%]{min-width:220px;max-width:calc(100vw - 2rem);right:auto;left:0}}.suggestions-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid var(--border-color);background:linear-gradient(135deg,#667eea1a,#764ba21a)}.suggestions-header[_ngcontent-%COMP%]   .suggestions-title[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;color:var(--text-primary)}.suggestions-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;line-height:1;color:var(--text-secondary);cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s ease}.suggestions-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:var(--bg-hover);color:var(--text-primary)}.suggestions-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;padding:.5rem}.suggestions-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.suggestions-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:3px}.suggestions-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.suggestions-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}.tag-suggestion-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;padding:.625rem 1rem;margin-bottom:.25rem;background:var(--bg-primary);border:1px solid var(--border-color);border-radius:8px;cursor:pointer;transition:all .15s ease;text-align:left}.tag-suggestion-item[_ngcontent-%COMP%]:hover:not(.already-added){background:var(--bg-hover);border-color:var(--primary-color);transform:translate(4px)}.tag-suggestion-item.already-added[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;background:var(--bg-secondary)}.tag-suggestion-item[_ngcontent-%COMP%]:active:not(.already-added){transform:translate(2px) scale(.98)}.tag-suggestion-item[_ngcontent-%COMP%]   .tag-text[_ngcontent-%COMP%]{flex:1;color:var(--text-primary);font-size:.875rem;font-weight:500}.tag-suggestion-item[_ngcontent-%COMP%]   .tag-icon[_ngcontent-%COMP%]{color:var(--primary-color);font-size:1.25rem;margin-left:.75rem;flex-shrink:0;font-weight:700}.tag-suggestion-item[_ngcontent-%COMP%]   .tag-status[_ngcontent-%COMP%]{color:var(--primary-color);font-size:1rem;margin-left:.75rem;flex-shrink:0}.tag-suggestion-item[_ngcontent-%COMP%]:hover:not(.already-added)   .tag-icon[_ngcontent-%COMP%]{transform:scale(1.2)}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:2rem 1rem;text-align:center;color:var(--text-secondary);font-size:.875rem;display:flex;flex-direction:column;align-items:center;gap:.75rem}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}"]})};var Le=(o,t)=>t.id;function Ae(o,t){if(o&1){let e=v();s(0,"button",40),m("click",function(){d(e);let i=l();return g(i.deleteNote())}),M(1,"app-icon",41),c()}o&2&&(r(),u("size",20))}function Ze(o,t){o&1&&M(0,"app-icon",9),o&2&&u("size",20)}function Fe(o,t){o&1&&M(0,"app-icon",10),o&2&&u("size",20)}function Ue(o,t){if(o&1){let e=v();s(0,"app-ai-magic-button",42),m("improved",function(i){d(e);let a=l();return g(a.onImprovedTitle(i))}),c()}if(o&2){let e=l();u("text",e.title())}}function je(o,t){o&1&&(s(0,"option",17),p(1,"Loading categories..."),c())}function $e(o,t){if(o&1&&(s(0,"option",43),p(1),c()),o&2){let e=t.$implicit;u("value",e.id),r(),D(e.name)}}function Be(o,t){if(o&1&&N(0,$e,2,2,"option",43,Le),o&2){let e=l();z(e.categories())}}function Ye(o,t){if(o&1){let e=v();s(0,"div",20)(1,"app-ai-magic-button",44),m("improved",function(i){d(e);let a=l();return g(a.onImprovedContent(i))}),c()()}if(o&2){let e=l();r(),u("text",e.content())}}function We(o,t){if(o&1){let e=v();s(0,"app-ai-tag-suggestions",45),m("tagSelected",function(i){d(e);let a=l();return g(a.onAITagSelected(i))}),c()}if(o&2){let e=l();u("content",e.content())("title",e.title())("existingTags",e.tags())}}function He(o,t){if(o&1){let e=v();s(0,"span",26),p(1),s(2,"button",46),m("click",function(){let i=d(e).$implicit,a=l();return g(a.removeTag(i))}),p(3,"\xD7"),c()()}if(o&2){let e=t.$implicit;r(),j(" ",e," ")}}function Re(o,t){o&1&&p(0," Uploading... ")}function Ge(o,t){o&1&&p(0," Loading... ")}function Xe(o,t){if(o&1&&(s(0,"div",49),M(1,"div",51),s(2,"span",52),h(3,Re,1,0)(4,Ge,1,0),c()()),o&2){let e=l().$index,n=l();r(3),x(n.imageUploading()[e]===!0?3:4)}}function Qe(o,t){if(o&1){let e=v();s(0,"div",47)(1,"img",48),m("load",function(i){d(e);let a=l();return g(a.onImageLoad(i))})("error",function(i){d(e);let a=l();return g(a.onImageError(i))})("click",function(){let i=d(e).$index,a=l();return g(a.openImagePreview(i))}),c(),h(2,Xe,5,1,"div",49),s(3,"button",50),m("click",function(i){let a=d(e).$index;return l().removeImage(a),g(i.stopPropagation())}),p(4,"\xD7"),c()()}if(o&2){let e=t.$implicit,n=t.$index,i=l();T("uploading",i.imageUploading()[n]===!0),r(),T("loaded",i.imageLoaded()[n]===!0&&i.imageUploading()[n]!==!0)("loading",i.imageLoaded()[n]!==!0||i.imageUploading()[n]===!0),u("src",e,L),r(),x(i.imageUploading()[n]===!0||i.imageLoaded()[n]!==!0&&i.imageUploading()[n]!==!0?2:-1)}}function Je(o,t){if(o&1&&(s(0,"p",55),p(1),c()),o&2){let e=l().$implicit;r(),D(e.description)}}function Ke(o,t){if(o&1){let e=v();s(0,"div",36)(1,"div",53)(2,"a",54),p(3),c(),h(4,Je,2,1,"p",55),s(5,"span",56),p(6),c()(),s(7,"button",57),m("click",function(){let i=d(e).$index,a=l();return g(a.removeLink(i))}),p(8,"\xD7"),c()()}if(o&2){let e=t.$implicit;r(2),u("href",e.url,L),r(),j(" ",e.title," "),r(),x(e.description?4:-1),r(2),D(e.url)}}function qe(o,t){if(o&1){let e=v();s(0,"div",37)(1,"input",58),m("input",function(i){d(e);let a=l();return g(a.linkUrl.set(i.target.value))}),c(),s(2,"input",59),m("input",function(i){d(e);let a=l();return g(a.linkTitle.set(i.target.value))}),c(),s(3,"input",60),m("input",function(i){d(e);let a=l();return g(a.linkDescription.set(i.target.value))}),c(),s(4,"div",61)(5,"button",62),m("click",function(){d(e);let i=l();return g(i.addLink())}),p(6,"Add"),c(),s(7,"button",63),m("click",function(){d(e);let i=l();return g(i.showLinkForm.set(!1))}),p(8,"Cancel"),c()()()}if(o&2){let e=l();r(),u("value",e.linkUrl()),r(),u("value",e.linkTitle()),r(),u("value",e.linkDescription())}}function et(o,t){if(o&1){let e=v();s(0,"button",63),m("click",function(){d(e);let i=l();return g(i.showLinkForm.set(!0))}),M(1,"app-icon",64),s(2,"span"),p(3,"Add Link"),c()()}o&2&&(r(),u("size",18))}function tt(o,t){if(o&1){let e=v();s(0,"button",78),m("click",function(i){return d(e),l(2).resetImageZoom(),g(i.stopPropagation())}),M(1,"app-icon",79),c()}o&2&&(r(),u("size",18))}function nt(o,t){if(o&1){let e=v();s(0,"button",80),m("click",function(i){return d(e),l(2).previousImage(),g(i.stopPropagation())}),M(1,"app-icon",4),c(),s(2,"button",81),m("click",function(i){return d(e),l(2).nextImage(),g(i.stopPropagation())}),M(3,"app-icon",82),c()}if(o&2){let e=l(2);u("disabled",e.previewImageIndex()===0),r(),u("size",24),r(),u("disabled",e.previewImageIndex()===e.images().length-1),r(),u("size",24)}}function it(o,t){if(o&1&&(s(0,"div",77),p(1),c()),o&2){let e=l(2);r(),ne(" ",e.previewImageIndex()+1," / ",e.images().length," ")}}function ot(o,t){if(o&1){let e=v();s(0,"div",65),m("click",function(){d(e);let i=l();return g(i.closeImagePreview())}),s(1,"div",66),m("click",function(i){return d(e),g(i.stopPropagation())}),s(2,"button",67),m("click",function(){d(e);let i=l();return g(i.closeImagePreview())}),M(3,"app-icon",68),c(),s(4,"div",69)(5,"button",70),m("click",function(i){return d(e),l().zoomOut(),g(i.stopPropagation())}),s(6,"span",71),p(7,"\u2212"),c()(),s(8,"span",72),p(9),c(),s(10,"button",73),m("click",function(i){return d(e),l().zoomIn(),g(i.stopPropagation())}),s(11,"span",71),p(12,"+"),c()(),h(13,tt,2,1,"button",74),c(),h(14,nt,4,4),s(15,"div",75),m("wheel",function(i){d(e);let a=l();return g(a.onImageWheel(i))})("mousedown",function(i){d(e);let a=l();return g(a.onImageMouseDown(i))})("mousemove",function(i){d(e);let a=l();return g(a.onImageMouseMove(i))})("mouseup",function(){d(e);let i=l();return g(i.onImageMouseUp())})("mouseleave",function(){d(e);let i=l();return g(i.onImageMouseUp())})("touchstart",function(i){d(e);let a=l();return g(a.onImageTouchStart(i))})("touchmove",function(i){d(e);let a=l();return g(a.onImageTouchMove(i))})("touchend",function(i){d(e);let a=l();return g(a.onImageTouchEnd(i))})("touchcancel",function(i){d(e);let a=l();return g(a.onImageTouchEnd(i))}),M(16,"img",76),c(),h(17,it,2,2,"div",77),c()()}if(o&2){let e=l();r(3),u("size",24),r(2),u("disabled",e.imageZoom()<=1),r(4),j("",e.Math.round(e.imageZoom()*100),"%"),r(),u("disabled",e.imageZoom()>=5),r(3),x(e.imageZoom()>1?13:-1),r(),x(e.images().length>1?14:-1),r(),X("cursor",e.imageZoom()>1?e.isDragging()?"grabbing":"grab":"default"),r(),X("transform","scale("+e.imageZoom()+") translate("+e.imagePosition().x+"px, "+e.imagePosition().y+"px)")("transition",e.isDragging()?"none":"transform 0.2s ease"),u("src",e.images()[e.previewImageIndex()],L),r(),x(e.images().length>1?17:-1)}}var Pe=class o{route=S(oe);router=S(ae);store=S(ce);authService=S(re);notesService=S(se);title=_("");content=_("");categoryId=_("");tags=_([]);images=_([]);links=_([]);tagInput=_("");linkUrl=_("");linkTitle=_("");linkDescription=_("");showLinkForm=_(!1);isSaving=_(!1);imageLoaded=_({});imageUploading=_({});previewImageIndex=_(null);keyDownHandler=this.handleKeyDown.bind(this);imageZoom=_(1);imagePosition=_({x:0,y:0});isDragging=_(!1);dragStart=_(null);touchStartDistance=_(null);touchStartZoom=_(1);noteId=_(null);isEditMode=ie(()=>this.noteId()!==null);categories=this.store.selectSignal(xe);allNotes=this.store.selectSignal(he);constructor(){Q(()=>{let t=this.noteId(),e=this.allNotes();t&&e.length>0&&this.loadNote(t)}),Q(()=>{let t=this.categories(),e=this.categoryId();if(!this.isEditMode()&&t.length>0&&!e){let n=t[0];n&&this.categoryId.set(n.id)}})}ngOnInit(){let t=this.authService.currentUser()?.email||null;this.notesService.loadFromStorage(t),this.store.dispatch(V.loadNotes()),this.store.dispatch(le.loadCategories()),document.addEventListener("keydown",this.keyDownHandler),this.route.paramMap.subscribe(e=>{let n=e.get("id");if(n&&n!=="new")this.noteId.set(n),this.allNotes().length>0&&this.loadNote(n);else{this.noteId.set(null),this.title.set(""),this.content.set(""),this.tags.set([]),this.images.set([]),this.links.set([]);let i=this.categories();i.length>0&&this.categoryId.set(i[0].id)}})}loadNote(t){let n=this.allNotes().find(i=>i.id===t);if(n){this.title.set(n.title),this.content.set(n.content),this.categoryId.set(n.categoryId),this.tags.set(n.tags||[]);let i=n.images||[];this.images.set(i),this.imageUploading.set({});let a={};i.forEach((f,C)=>{f.startsWith("data:")?a[C]=!0:a[C]=!1}),this.imageLoaded.set(a),i.length>0&&setTimeout(()=>{let f=this.images(),C=b({},this.imageLoaded());f.forEach((Y,W)=>{Y.startsWith("data:")&&(C[W]=!0)}),this.imageLoaded.set(C)},100),this.links.set(n.links||[])}else console.warn(`Note with id ${t} not found`)}onImageUpload(t){let e=t.target;if(e.files&&e.files.length>0){let n=e.files[0];if(n.type.startsWith("image/")){let a=n.size/1048576;if(a>10&&!confirm(`Image is ${a.toFixed(2)}MB. Large images may affect performance. Continue with 100% quality?`)){e.value="";return}let C=this.images().length,Y="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5VcGxvYWRpbmcuLi48L3RleHQ+PC9zdmc+";this.images.update(O=>[...O,Y]),this.imageUploading.update(O=>I(b({},O),{[C]:!0})),this.imageLoaded.update(O=>I(b({},O),{[C]:!1}));let W=n.type==="image/png"||n.type==="image/webp"||n.type==="image/gif"||n.type==="image/bmp",H=new FileReader;H.onload=O=>{let E=O.target?.result;if(!E||!E.startsWith("data:image/")){console.error("Invalid image data"),this.images.update(k=>k.filter((y,we)=>we!==C)),this.imageUploading.update(k=>{let y=b({},k);return delete y[C],y}),alert("Failed to process image. Please try again.");return}this.images.update(k=>{let y=[...k];return y[C]=E,y}),this.imageUploading.update(k=>{let y=b({},k);return delete y[C],y}),setTimeout(()=>{this.imageLoaded.update(k=>I(b({},k),{[C]:!0}))},100),console.log("Image uploaded at 100% quality:",{type:n.type,size:`${a.toFixed(2)}MB`,lossless:W,base64Length:`${(E.length/1024).toFixed(2)}KB`})},H.onerror=()=>{console.error("Error reading image file"),this.images.update(O=>O.filter((E,k)=>k!==C)),this.imageUploading.update(O=>{let E=b({},O);return delete E[C],E}),alert("Failed to read image file. Please try again.")},H.readAsDataURL(n)}else alert("Please select a valid image file."),e.value=""}e.value=""}removeImage(t){this.images.update(i=>i.filter((a,f)=>f!==t));let e=b({},this.imageLoaded());delete e[t],this.imageLoaded.set(e);let n=b({},this.imageUploading());delete n[t],this.imageUploading.set(n),this.previewImageIndex()===t&&this.previewImageIndex.set(null)}openImagePreview(t){this.previewImageIndex.set(t),this.imageZoom.set(1),this.imagePosition.set({x:0,y:0})}closeImagePreview(){this.previewImageIndex.set(null),this.imageZoom.set(1),this.imagePosition.set({x:0,y:0})}nextImage(){let t=this.previewImageIndex();t!==null&&t<this.images().length-1&&(this.previewImageIndex.set(t+1),this.imageZoom.set(1),this.imagePosition.set({x:0,y:0}))}previousImage(){let t=this.previewImageIndex();t!==null&&t>0&&(this.previewImageIndex.set(t-1),this.imageZoom.set(1),this.imagePosition.set({x:0,y:0}))}onImageWheel(t){if(this.previewImageIndex()===null)return;t.preventDefault();let e=t.deltaY>0?-.1:.1,n=Math.max(1,Math.min(5,this.imageZoom()+e));this.imageZoom.set(n),n===1&&this.imagePosition.set({x:0,y:0})}onImageMouseDown(t){this.imageZoom()<=1||(this.isDragging.set(!0),this.dragStart.set({x:t.clientX-this.imagePosition().x,y:t.clientY-this.imagePosition().y}))}onImageMouseMove(t){if(!this.isDragging()||!this.dragStart())return;let e=t.clientX-this.dragStart().x,n=t.clientY-this.dragStart().y;this.imagePosition.set({x:e,y:n})}onImageMouseUp(){this.isDragging.set(!1),this.dragStart.set(null)}resetImageZoom(){this.imageZoom.set(1),this.imagePosition.set({x:0,y:0})}zoomIn(){let t=Math.min(5,this.imageZoom()+.5);this.imageZoom.set(t)}zoomOut(){let t=Math.max(1,this.imageZoom()-.5);this.imageZoom.set(t),t===1&&this.imagePosition.set({x:0,y:0})}getTouchDistance(t,e){let n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)}onImageTouchStart(t){if(t.touches.length===2){let e=this.getTouchDistance(t.touches[0],t.touches[1]);this.touchStartDistance.set(e),this.touchStartZoom.set(this.imageZoom()),t.preventDefault()}else if(t.touches.length===1&&this.imageZoom()>1){let e=t.touches[0];this.isDragging.set(!0),this.dragStart.set({x:e.clientX-this.imagePosition().x,y:e.clientY-this.imagePosition().y})}}onImageTouchMove(t){if(t.touches.length===2&&this.touchStartDistance()!==null){let n=this.getTouchDistance(t.touches[0],t.touches[1])/this.touchStartDistance(),i=Math.max(1,Math.min(5,this.touchStartZoom()*n));this.imageZoom.set(i),t.preventDefault()}else if(t.touches.length===1&&this.isDragging()&&this.dragStart()){let e=t.touches[0],n=e.clientX-this.dragStart().x,i=e.clientY-this.dragStart().y;this.imagePosition.set({x:n,y:i}),t.preventDefault()}}onImageTouchEnd(t){t.touches.length<2&&this.touchStartDistance.set(null),t.touches.length===0&&(this.isDragging.set(!1),this.dragStart.set(null))}onImageLoad(t){let e=t.target,n=this.images(),i=-1;for(let a=0;a<n.length;a++){let f=n[a];if(f.startsWith("data:")){if(e.src===f||e.src.includes(f.substring(0,50))){i=a;break}}else if(e.src===f||e.src.endsWith(f)){i=a;break}}i!==-1&&this.imageLoaded.update(a=>I(b({},a),{[i]:!0}))}onImageError(t){let e=t.target,n=this.images(),i=-1;for(let a=0;a<n.length;a++){let f=n[a];if(e.src===f||e.src.includes(f.substring(0,50))){i=a;break}}i!==-1&&(e.style.opacity="0",e.style.display="none",this.imageLoaded.update(a=>{let f=b({},a);return delete f[i],f}))}addTag(){let t=this.tagInput().trim();t&&!this.tags().includes(t)&&(this.tags.update(e=>[...e,t]),this.tagInput.set(""))}removeTag(t){this.tags.update(e=>e.filter(n=>n!==t))}addLink(){let t=this.linkUrl().trim(),e=this.linkTitle().trim()||t;if(t){let n={url:t,title:e,description:this.linkDescription().trim()||void 0};this.links.update(i=>[...i,n]),this.linkUrl.set(""),this.linkTitle.set(""),this.linkDescription.set(""),this.showLinkForm.set(!1)}}removeLink(t){this.links.update(e=>e.filter((n,i)=>i!==t))}saveNote(){if(!this.title().trim()&&!this.content().trim())return;if(!this.categoryId()||this.categoryId().trim()===""){let e=this.categories()[0];if(e)this.categoryId.set(e.id);else{console.error("No category available. Please create a category first.");return}}this.isSaving.set(!0);let t={title:this.title().trim()||"Untitled Note",content:this.content().trim(),categoryId:this.categoryId(),tags:this.tags().length>0?this.tags():void 0,images:this.images().length>0?this.images():void 0,links:this.links().length>0?this.links():void 0};if(this.isEditMode()){let e=this.noteId();if(!e){console.error("Note ID is missing"),this.isSaving.set(!1);return}this.store.dispatch(V.updateNote({id:e,updates:t}))}else this.store.dispatch(V.createNote({note:t}));setTimeout(()=>{this.isSaving.set(!1),this.router.navigate(["/"])},300)}deleteNote(){this.noteId()&&confirm("Are you sure you want to delete this note?")&&(this.store.dispatch(V.deleteNote({id:this.noteId()})),this.router.navigate(["/"]))}cancel(){this.router.navigate(["/"])}handleKeyDown(t){if(this.previewImageIndex()!==null)switch(t.key){case"Escape":this.closeImagePreview();break;case"ArrowRight":t.preventDefault(),this.imageZoom()>1?this.imagePosition.update(e=>I(b({},e),{x:e.x-50})):this.nextImage();break;case"ArrowLeft":t.preventDefault(),this.imageZoom()>1?this.imagePosition.update(e=>I(b({},e),{x:e.x+50})):this.previousImage();break;case"ArrowUp":t.preventDefault(),this.imageZoom()>1&&this.imagePosition.update(e=>I(b({},e),{y:e.y+50}));break;case"ArrowDown":t.preventDefault(),this.imageZoom()>1&&this.imagePosition.update(e=>I(b({},e),{y:e.y-50}));break;case"+":case"=":t.preventDefault(),this.zoomIn();break;case"-":case"_":t.preventDefault(),this.zoomOut();break;case"0":t.preventDefault(),this.resetImageZoom();break}}onImprovedTitle(t){this.title.set(t.trim())}onImprovedContent(t){this.content.set(t.trim())}onAITagSelected(t){t&&!this.tags().includes(t)&&this.tags.update(e=>[...e,t])}Math=Math;ngOnDestroy(){document.removeEventListener("keydown",this.keyDownHandler)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=A({type:o,selectors:[["app-note-editor"]],decls:58,vars:17,consts:[[1,"note-editor"],[1,"editor-container"],[1,"editor-header"],["aria-label","Back",1,"icon-btn","back-btn",3,"click"],["name","back",3,"size"],[1,"editor-title"],[1,"header-actions"],["aria-label","Delete",1,"icon-btn","danger-btn"],["aria-label","Save",1,"icon-btn","save-btn",3,"click","disabled"],["name","sync-loading",3,"size"],["name","save",3,"size"],[1,"editor-content",3,"submit"],[1,"title-input-wrapper"],["type","text","name","note-title","id","note-title","placeholder","Note Title","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Note title",1,"note-title-input",3,"input","value"],["context","note","tooltipText","Improve title with AI",3,"text"],[1,"form-group"],["name","note-category","id","note-category","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Note category",1,"form-select",3,"change","value","disabled"],["value",""],[1,"content-input-wrapper"],["name","note-content","id","note-content","placeholder","Start writing...","rows","8","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","role","textbox","aria-label","Note content",1,"note-content-input",3,"input","value"],[1,"content-ai-button"],[1,"form-section"],[1,"tags-section-header"],[3,"content","title","existingTags"],[1,"tags-container"],[1,"tags-list"],[1,"tag"],[1,"tag-input-group"],["type","text","name","tag-input","id","tag-input","placeholder","Add tag","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Add tag",1,"tag-input",3,"input","keyup.enter","value"],[1,"btn","btn-small",3,"click"],[1,"images-container"],[1,"image-preview",3,"uploading"],[1,"image-upload-btn"],["type","file","accept","image/*",2,"display","none",3,"change"],["name","image",3,"size"],[1,"links-container"],[1,"link-item"],[1,"link-form"],["type","button",1,"btn","btn-secondary"],[1,"image-preview-modal"],["aria-label","Delete",1,"icon-btn","danger-btn",3,"click"],["name","delete",3,"size"],["context","note","tooltipText","Improve title with AI",3,"improved","text"],[3,"value"],["context","note","tooltipText","Improve content with AI",3,"improved","text"],[3,"tagSelected","content","title","existingTags"],[1,"tag-remove",3,"click"],[1,"image-preview"],["alt","Note image","loading","eager",2,"cursor","pointer",3,"load","error","click","src"],[1,"image-loading"],["aria-label","Remove image",1,"image-remove",3,"click"],[1,"loading-spinner"],[1,"loading-text"],[1,"link-content"],["target","_blank",1,"link-title",3,"href"],[1,"link-description"],[1,"link-url"],[1,"link-remove",3,"click"],["type","url","name","link-url","id","link-url","placeholder","URL","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Link URL",1,"form-input",3,"input","value"],["type","text","name","link-title","id","link-title","placeholder","Title (optional)","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Link title",1,"form-input",3,"input","value"],["type","text","name","link-description","id","link-description","placeholder","Description (optional)","autocomplete","off","data-form-type","other","data-lpignore","true","data-1p-ignore","true","data-bwignore","true","aria-label","Link description",1,"form-input",3,"input","value"],[1,"link-form-actions"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],["name","link",3,"size"],[1,"image-preview-modal",3,"click"],[1,"modal-content",3,"click"],["aria-label","Close preview",1,"modal-close",3,"click"],["name","close",3,"size"],[1,"zoom-controls"],["aria-label","Zoom out",1,"zoom-btn",3,"click","disabled"],[2,"font-size","18px","color","white","font-weight","bold"],[1,"zoom-level"],["aria-label","Zoom in",1,"zoom-btn",3,"click","disabled"],["aria-label","Reset zoom",1,"zoom-btn","reset-btn"],[1,"image-container",3,"wheel","mousedown","mousemove","mouseup","mouseleave","touchstart","touchmove","touchend","touchcancel"],["alt","Preview image","loading","eager","draggable","false","decoding","async","fetchpriority","high",1,"preview-image",3,"src"],[1,"image-counter"],["aria-label","Reset zoom",1,"zoom-btn","reset-btn",3,"click"],["name","sync",3,"size"],["aria-label","Previous image",1,"modal-nav","modal-nav-prev",3,"click","disabled"],["aria-label","Next image",1,"modal-nav","modal-nav-next",3,"click","disabled"],["name","back",2,"transform","rotate(180deg)",3,"size"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"div",1)(2,"header",2)(3,"button",3),m("click",function(){return n.cancel()}),M(4,"app-icon",4),c(),s(5,"h2",5),p(6),c(),s(7,"div",6),M(8,"app-theme-toggle"),h(9,Ae,2,1,"button",7),s(10,"button",8),m("click",function(){return n.saveNote()}),h(11,Ze,1,1,"app-icon",9)(12,Fe,1,1,"app-icon",10),c()()(),s(13,"form",11),m("submit",function(a){return a.preventDefault()}),s(14,"div",12)(15,"input",13),m("input",function(a){return n.title.set(a.target.value)}),c(),h(16,Ue,1,1,"app-ai-magic-button",14),c(),s(17,"div",15)(18,"select",16),m("change",function(a){return n.categoryId.set(a.target.value)}),h(19,je,2,0,"option",17)(20,Be,2,0),c()(),s(21,"div",18)(22,"textarea",19),m("input",function(a){return n.content.set(a.target.value)}),c(),h(23,Ye,2,1,"div",20),c(),s(24,"div",21)(25,"div",22)(26,"label"),p(27,"Tags"),c(),h(28,We,1,3,"app-ai-tag-suggestions",23),c(),s(29,"div",24)(30,"div",25),N(31,He,4,1,"span",26,Z),c(),s(33,"div",27)(34,"input",28),m("input",function(a){return n.tagInput.set(a.target.value)})("keyup.enter",function(a){return n.addTag(),a.preventDefault()}),c(),s(35,"button",29),m("click",function(){return n.addTag()}),p(36,"Add"),c()()()(),s(37,"div",21)(38,"label"),p(39,"Images"),c(),s(40,"div",30),N(41,Qe,5,8,"div",31,R),s(43,"label",32)(44,"input",33),m("change",function(a){return n.onImageUpload(a)}),c(),M(45,"app-icon",34),s(46,"span"),p(47,"Add"),c()()()(),s(48,"div",21)(49,"label"),p(50,"Links"),c(),s(51,"div",35),N(52,Ke,9,4,"div",36,R),h(54,qe,9,3,"div",37)(55,et,4,1,"button",38),c()()()(),h(56,ot,18,14,"div",39),M(57,"app-bottom-nav"),c()),e&2&&(r(4),u("size",20),r(2),D(n.isEditMode()?"Edit Note":"New Note"),r(3),x(n.isEditMode()?9:-1),r(),u("disabled",n.isSaving()),r(),x(n.isSaving()?11:12),r(4),u("value",n.title()),r(),x(n.title()?16:-1),r(2),u("value",n.categoryId())("disabled",n.categories().length===0),r(),x(n.categories().length===0?19:20),r(3),u("value",n.content()),r(),x(n.content()?23:-1),r(5),x(n.title()||n.content()?28:-1),r(3),z(n.tags()),r(3),u("value",n.tagInput()),r(7),z(n.images()),r(4),u("size",20),r(7),z(n.links()),r(2),x(n.showLinkForm()?54:55),r(2),x(n.previewImageIndex()!==null?56:-1))},dependencies:[$,_e,me,pe,ue,de,ge,Ce,Me,fe,ve,B],styles:['.note-editor[_ngcontent-%COMP%]{min-height:100vh;background:var(--bg-primary);padding-bottom:env(safe-area-inset-bottom);transition:background-color .3s ease}.editor-container[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;background:var(--bg-elevated);min-height:100vh;border:none;box-shadow:none}@media (min-width: 768px){.editor-container[_ngcontent-%COMP%]{max-width:800px;border-radius:var(--radius-lg);margin:2rem auto;box-shadow:var(--shadow-lg);min-height:calc(100vh - 4rem)}}@media (min-width: 1024px){.editor-container[_ngcontent-%COMP%]{max-width:900px}}.editor-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;border-bottom:1px solid var(--border-color);background:var(--bg-elevated);position:sticky;top:0;z-index:10;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);box-shadow:var(--shadow-sm);transition:background-color .3s ease,border-color .3s ease}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:12px;width:44px;height:44px;min-width:44px;min-height:44px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-primary);transition:all .2s cubic-bezier(.4,0,.2,1);flex-shrink:0;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--text-primary);transition:transform .2s ease}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{transform:scale(.92);background:var(--bg-hover)}.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active   app-icon[_ngcontent-%COMP%]{transform:translate(-2px)}@media (max-width: 640px){.editor-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{width:48px;height:48px;min-width:48px;min-height:48px}}.editor-header[_ngcontent-%COMP%]   .editor-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:1.125rem;font-weight:600;color:var(--text-primary)}.editor-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:12px;width:44px;height:44px;min-width:44px;min-height:44px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);padding:0;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--text-secondary);transition:color .2s ease}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.92);background:var(--bg-hover)}.editor-header[_ngcontent-%COMP%]   .icon-btn.save-btn[_ngcontent-%COMP%]{background:var(--primary-color);color:var(--text-inverse);border-color:var(--primary-color);box-shadow:var(--shadow-sm)}.editor-header[_ngcontent-%COMP%]   .icon-btn.save-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--text-inverse)}.editor-header[_ngcontent-%COMP%]   .icon-btn.save-btn[_ngcontent-%COMP%]:active:not(:disabled){background:var(--primary-hover);transform:scale(.92);box-shadow:var(--shadow-md)}.editor-header[_ngcontent-%COMP%]   .icon-btn.danger-btn[_ngcontent-%COMP%]{background:var(--error-color);color:var(--text-inverse);border-color:var(--error-color);box-shadow:var(--shadow-sm)}.editor-header[_ngcontent-%COMP%]   .icon-btn.danger-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--text-inverse)}.editor-header[_ngcontent-%COMP%]   .icon-btn.danger-btn[_ngcontent-%COMP%]:active:not(:disabled){background:#dc2626;transform:scale(.92);box-shadow:var(--shadow-md)}.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}@media (max-width: 640px){.editor-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{width:48px;height:48px;min-width:48px;min-height:48px}}.editor-content[_ngcontent-%COMP%]{padding:1rem;padding-bottom:calc(1rem + env(safe-area-inset-bottom))}@media (max-width: 640px){.editor-content[_ngcontent-%COMP%]{padding:.75rem;padding-bottom:calc(.75rem + env(safe-area-inset-bottom) + 80px)}}@media (min-width: 768px){.editor-content[_ngcontent-%COMP%]{padding:2rem;max-width:100%}}.title-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.title-input-wrapper[_ngcontent-%COMP%]   .note-title-input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;font-size:1.5rem;font-weight:600;color:var(--text-primary);padding:.5rem 0;background:transparent}@media (max-width: 640px){.title-input-wrapper[_ngcontent-%COMP%]   .note-title-input[_ngcontent-%COMP%]{font-size:1.25rem;font-size:20px;padding:.375rem 0}}.title-input-wrapper[_ngcontent-%COMP%]   app-ai-magic-button[_ngcontent-%COMP%]{flex-shrink:0}.note-title-input[_ngcontent-%COMP%]{width:100%;border:none;outline:none;font-size:1.5rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem;padding:.5rem 0;background:transparent}@media (max-width: 640px){.note-title-input[_ngcontent-%COMP%]{font-size:1.25rem;font-size:20px;padding:.375rem 0}}.note-title-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:1rem;background:var(--bg-primary);color:var(--text-primary);cursor:pointer}@media (max-width: 640px){.form-select[_ngcontent-%COMP%]{font-size:16px;padding:.625rem}}.form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.content-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:1.5rem}.content-input-wrapper[_ngcontent-%COMP%]   .note-content-input[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border-color);border-radius:var(--radius-sm);padding:1rem;font-size:1rem;line-height:1.6;color:var(--text-primary);resize:vertical;min-height:200px;font-family:inherit;background:var(--bg-primary)}@media (max-width: 640px){.content-input-wrapper[_ngcontent-%COMP%]   .note-content-input[_ngcontent-%COMP%]{min-height:150px}}.content-input-wrapper[_ngcontent-%COMP%]   .content-ai-button[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;z-index:1}.note-content-input[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border-color);border-radius:var(--radius-sm);padding:1rem;font-size:1rem;line-height:1.6;color:var(--text-primary);resize:vertical;min-height:200px;margin-bottom:1.5rem;font-family:inherit;background:var(--bg-primary)}@media (max-width: 640px){.note-content-input[_ngcontent-%COMP%]{min-height:150px;padding:.75rem;font-size:16px}}.note-content-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.note-content-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.form-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.75rem;font-weight:500;color:var(--text-primary);font-size:.875rem}.form-section[_ngcontent-%COMP%]   .tags-section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem}.form-section[_ngcontent-%COMP%]   .tags-section-header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0}.tags-container[_ngcontent-%COMP%]   .tags-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.75rem}@media (max-width: 640px){.tags-container[_ngcontent-%COMP%]   .tags-list[_ngcontent-%COMP%]{gap:.375rem}}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;background:var(--primary-color);color:var(--text-inverse);padding:.5rem .75rem;border-radius:16px;font-size:.875rem;font-weight:500}@media (max-width: 640px){.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{padding:.375rem .625rem;font-size:.8125rem}}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-inverse);cursor:pointer;font-size:1.125rem;line-height:1;padding:0;width:18px;height:18px;display:flex;align-items:center;justify-content:center;border-radius:50%}.tags-container[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]:active{background:#fff3}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media (max-width: 640px){.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:1rem;background:var(--bg-primary);color:var(--text-primary)}@media (max-width: 640px){.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]{font-size:16px;padding:.625rem}}.tags-container[_ngcontent-%COMP%]   .tag-input-group[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.images-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}@media (max-width: 640px){.images-container[_ngcontent-%COMP%]{gap:.5rem}}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]{position:relative;width:100px;height:100px;min-width:100px;min-height:100px;border-radius:var(--radius-sm);overflow:hidden;border:2px solid var(--border-color);background:var(--bg-secondary);flex-shrink:0}@media (max-width: 640px){.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]{width:88px;height:88px;min-width:88px;min-height:88px}}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:opacity .2s ease;display:block}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[src^="data:"][_ngcontent-%COMP%]{opacity:1!important;visibility:visible!important}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img.loaded[_ngcontent-%COMP%]{opacity:1;visibility:visible}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img.loading[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.loaded):not(.loading){opacity:1;visibility:visible}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-loading[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-loading[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:.5rem}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-loading[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:#fff;font-size:.875rem;font-weight:500;text-shadow:0 1px 2px rgba(0,0,0,.3)}.images-container[_ngcontent-%COMP%]   .image-preview.uploading[_ngcontent-%COMP%]{opacity:.8}.images-container[_ngcontent-%COMP%]   .image-preview.uploading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:blur(2px)}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-remove[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;background:#000000b3;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;z-index:2}.images-container[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-remove[_ngcontent-%COMP%]:active{background:#000000e6}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]{width:100px;height:100px;min-width:100px;min-height:100px;border:2px dashed var(--border-color);border-radius:var(--radius-sm);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.375rem;cursor:pointer;background:var(--bg-secondary);transition:all .2s cubic-bezier(.4,0,.2,1);touch-action:manipulation;-webkit-tap-highlight-color:transparent}@media (max-width: 640px){.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]{width:88px;height:88px;min-width:88px;min-height:88px}}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:var(--text-secondary);transition:all .2s ease}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]:active{border-color:var(--primary-color);background:var(--bg-hover);transform:scale(.95)}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]:active   app-icon[_ngcontent-%COMP%]{color:var(--primary-color);transform:scale(1.1)}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.75rem;font-weight:500;transition:color .2s ease}.images-container[_ngcontent-%COMP%]   .image-upload-btn[_ngcontent-%COMP%]:active   span[_ngcontent-%COMP%]{color:var(--primary-color)}.links-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}@media (max-width: 640px){.links-container[_ngcontent-%COMP%]{gap:.5rem}}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1rem;background:var(--bg-secondary);border-radius:var(--radius-sm);border:1px solid var(--border-color)}@media (max-width: 640px){.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{padding:.75rem}}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]{flex:1;min-width:0}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-title[_ngcontent-%COMP%]{display:block;font-weight:600;color:var(--primary-color);text-decoration:none;margin-bottom:.25rem;font-size:.875rem;word-break:break-word}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-description[_ngcontent-%COMP%]{margin:.25rem 0;color:var(--text-secondary);font-size:.75rem;word-break:break-word}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-content[_ngcontent-%COMP%]   .link-url[_ngcontent-%COMP%]{display:block;color:var(--text-tertiary);font-size:.7rem;word-break:break-all}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-remove[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);cursor:pointer;font-size:1.25rem;padding:.25rem;flex-shrink:0}.links-container[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]   .link-remove[_ngcontent-%COMP%]:active{color:var(--text-primary)}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]{padding:1rem;background:var(--bg-secondary);border-radius:var(--radius-sm);border:1px solid var(--border-color);display:flex;flex-direction:column;gap:.75rem}@media (max-width: 640px){.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]{padding:.75rem;gap:.5rem}}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:1rem;background:var(--bg-primary);color:var(--text-primary)}@media (max-width: 640px){.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{font-size:16px;padding:.625rem}}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .link-form-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media (max-width: 640px){.links-container[_ngcontent-%COMP%]   .link-form[_ngcontent-%COMP%]   .link-form-actions[_ngcontent-%COMP%]{flex-direction:column}}.btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:inherit}@media (max-width: 640px){.btn[_ngcontent-%COMP%]{min-height:48px;font-size:1rem}}.image-preview-modal[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000fa;z-index:10000;display:flex;align-items:center;justify-content:center;padding:1rem;animation:_ngcontent-%COMP%_fadeIn .2s ease;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);overflow:hidden}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{position:relative;max-width:100%;max-height:100%;display:flex;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden;touch-action:none;-webkit-user-select:none;user-select:none}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{max-width:none;max-height:none;width:auto;height:auto;min-width:100px;min-height:100px;object-fit:contain;border-radius:var(--radius-sm);box-shadow:0 20px 60px #00000080;transform-origin:center center;will-change:transform;image-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0)}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{touch-action:pan-x pan-y pinch-zoom;-webkit-user-select:none;user-select:none}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{position:absolute;top:1rem;left:50%;transform:translate(-50%);display:flex;align-items:center;gap:.5rem;background:#000000b3;padding:.5rem 1rem;border-radius:24px;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:10002}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{top:.5rem;padding:.375rem .75rem;gap:.375rem}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{color:#fff;font-size:.875rem;font-weight:600;min-width:50px;text-align:center}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{font-size:.75rem;min-width:40px}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]{background:#fff3;border:none;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]{width:32px;height:32px}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:#fff}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff4d;transform:scale(1.1)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn.reset-btn[_ngcontent-%COMP%]{margin-left:.25rem;background:#ffffff26}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:#fff3;border:none;border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10001;transition:all .2s ease;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:#fff}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:scale(1.1)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{top:.5rem;right:.5rem;width:40px;height:40px}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);background:#fff3;border:none;border-radius:50%;width:48px;height:48px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10001;transition:all .2s ease;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:#fff}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff4d;transform:translateY(-50%) scale(1.1)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(-50%) scale(.95)}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav.modal-nav-prev[_ngcontent-%COMP%]{left:1rem}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav.modal-nav-prev[_ngcontent-%COMP%]{left:.5rem;width:40px;height:40px}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav.modal-nav-next[_ngcontent-%COMP%]{right:1rem}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-nav.modal-nav-next[_ngcontent-%COMP%]{right:.5rem;width:40px;height:40px}}.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .image-counter[_ngcontent-%COMP%]{position:absolute;bottom:1rem;left:50%;transform:translate(-50%);background:#000000b3;color:#fff;padding:.5rem 1rem;border-radius:20px;font-size:.875rem;font-weight:500;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}@media (max-width: 640px){.image-preview-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .image-counter[_ngcontent-%COMP%]{bottom:.5rem;padding:.375rem .75rem;font-size:.75rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}']})};export{Pe as NoteEditor};
